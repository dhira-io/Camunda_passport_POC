<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:zeebe="http://camunda.org/schema/zeebe/1.0" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:modeler="http://camunda.org/schema/modeler/1.0" id="Definitions_0mhc2c6" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="5.36.1" modeler:executionPlatform="Camunda Cloud" modeler:executionPlatformVersion="8.7.0">
  <bpmn:process id="PSK_Process" name="PSK_Process" isExecutable="true">
    <bpmn:startEvent id="StartEvent_1">
      <bpmn:outgoing>Flow_0ji44ap</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:sequenceFlow id="Flow_0ji44ap" sourceRef="StartEvent_1" targetRef="Token_Generation_Form" />
    <bpmn:userTask id="Token_Generation_Form" name="Token_Generation_Form">
      <bpmn:extensionElements>
        <zeebe:userTask />
        <zeebe:formDefinition formId="Main_Form" />
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_0ji44ap</bpmn:incoming>
      <bpmn:outgoing>Flow_1t7ecx0</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:sequenceFlow id="Flow_1t7ecx0" sourceRef="Token_Generation_Form" targetRef="Token_Bis_Rule" />
    <bpmn:businessRuleTask id="Token_Bis_Rule" name="Token_Bis_Rule">
      <bpmn:extensionElements>
        <zeebe:calledDecision decisionId="tokenGenerationDecision" resultVariable="tokenStatus" />
        <zeebe:ioMapping>
          <zeebe:input source="=documentType" target="documentType" />
          <zeebe:input source="=documentValidity" target="documentValidity" />
          <zeebe:input source="=applicantAge" target="applicantAge" />
          <zeebe:input source="=slotAvailable" target="slotAvailable" />
          <zeebe:input source="=location" target="location" />
          <zeebe:output source="=tokenStatus" target="tokenStatus" />
          <zeebe:output source="=zone" target="zone" />
        </zeebe:ioMapping>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1t7ecx0</bpmn:incoming>
      <bpmn:outgoing>Flow_0hvg73e</bpmn:outgoing>
    </bpmn:businessRuleTask>
    <bpmn:exclusiveGateway id="Gateway_1w27m3j">
      <bpmn:incoming>Flow_0hvg73e</bpmn:incoming>
      <bpmn:outgoing>Flow_0fdk3rs</bpmn:outgoing>
      <bpmn:outgoing>Flow_17lg5zp</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="Flow_0hvg73e" sourceRef="Token_Bis_Rule" targetRef="Gateway_1w27m3j" />
    <bpmn:sequenceFlow id="Flow_0fdk3rs" sourceRef="Gateway_1w27m3j" targetRef="CounterA">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=tokenStatus.tokenStatus != null and tokenStatus.tokenStatus = "ISSUED"</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:userTask id="CounterA" name="CounterA">
      <bpmn:extensionElements>
        <zeebe:userTask />
        <zeebe:formDefinition formId="CounterAForm" />
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_0fdk3rs</bpmn:incoming>
      <bpmn:outgoing>Flow_14w3to9</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:endEvent id="Event_0jomlvn">
      <bpmn:incoming>Flow_14w3to9</bpmn:incoming>
      <bpmn:incoming>Flow_17lg5zp</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_14w3to9" sourceRef="CounterA" targetRef="Event_0jomlvn" />
    <bpmn:sequenceFlow id="Flow_17lg5zp" sourceRef="Gateway_1w27m3j" targetRef="Event_0jomlvn">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=tokenStatus.tokenStatus = null 
</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="PSK_Process">
      <bpmndi:BPMNShape id="StartEvent_1_di" bpmnElement="StartEvent_1">
        <dc:Bounds x="182" y="152" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1wmyhu4_di" bpmnElement="Token_Generation_Form">
        <dc:Bounds x="270" y="130" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0yymfs1_di" bpmnElement="Token_Bis_Rule">
        <dc:Bounds x="450" y="130" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_1w27m3j_di" bpmnElement="Gateway_1w27m3j" isMarkerVisible="true">
        <dc:Bounds x="635" y="145" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0vp3kkm_di" bpmnElement="CounterA">
        <dc:Bounds x="770" y="130" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0jomlvn_di" bpmnElement="Event_0jomlvn">
        <dc:Bounds x="962" y="152" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_0ji44ap_di" bpmnElement="Flow_0ji44ap">
        <di:waypoint x="218" y="170" />
        <di:waypoint x="270" y="170" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1t7ecx0_di" bpmnElement="Flow_1t7ecx0">
        <di:waypoint x="370" y="170" />
        <di:waypoint x="450" y="170" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0hvg73e_di" bpmnElement="Flow_0hvg73e">
        <di:waypoint x="550" y="170" />
        <di:waypoint x="635" y="170" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0fdk3rs_di" bpmnElement="Flow_0fdk3rs">
        <di:waypoint x="685" y="170" />
        <di:waypoint x="770" y="170" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_17lg5zp_di" bpmnElement="Flow_17lg5zp">
        <di:waypoint x="660" y="145" />
        <di:waypoint x="660" y="80" />
        <di:waypoint x="980" y="80" />
        <di:waypoint x="980" y="152" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_14w3to9_di" bpmnElement="Flow_14w3to9">
        <di:waypoint x="870" y="170" />
        <di:waypoint x="962" y="170" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
